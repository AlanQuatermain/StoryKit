{"variants":[{"paths":["\/documentation\/storykit\/dataformats"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"content":[{"level":2,"text":"Authoring Source","anchor":"Authoring-Source","type":"heading"},{"inlineContent":[{"type":"text","text":"An authoring source directory typically contains:"}],"type":"paragraph"},{"syntax":null,"code":["<story-root>\/","  story.json","  texts\/","    <markdown files>.md","  assets\/            (optional)"],"type":"codeListing"},{"level":3,"text":"story.json","anchor":"storyjson","type":"heading"},{"inlineContent":[{"type":"text","text":"The structure file is a JSON object with these top‑level fields:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"metadata"},{"type":"text","text":": "},{"type":"codeVoice","code":"{ id: String, title: String, version: Int }"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"start"},{"type":"text","text":": "},{"type":"codeVoice","code":"String"},{"type":"text","text":" — the NodeID where the story begins"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"nodes"},{"type":"text","text":": "},{"type":"codeVoice","code":"Object"},{"type":"text","text":" — mapping from NodeID (string) to node objects"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"entities"},{"type":"text","text":" (optional): "},{"type":"codeVoice","code":"Object"},{"type":"text","text":" — mapping from entity id to entity descriptors (declarative only)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"globals"},{"type":"text","text":" (optional): "},{"type":"codeVoice","code":"{ globalActions: { String: GlobalAction } }"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"type":"text","text":"Node objects:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"id"},{"type":"text","text":": "},{"type":"codeVoice","code":"String"},{"type":"text","text":" — node identifier (should match the key)"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"text"},{"type":"text","text":": "},{"type":"codeVoice","code":"{ file: String, section: String }"},{"type":"text","text":" — Markdown location"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"tags","type":"codeVoice"},{"text":": ","type":"text"},{"code":"[String]","type":"codeVoice"},{"text":" — optional labels","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"onEnter"},{"type":"text","text":": "},{"code":"[EffectDescriptor]","type":"codeVoice"},{"type":"text","text":" — effects applied when entering"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"choices"},{"type":"text","text":": "},{"type":"codeVoice","code":"[Choice]"},{"type":"text","text":" — outgoing edges"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"terminal"},{"type":"text","text":": "},{"type":"codeVoice","code":"Bool"},{"type":"text","text":" — optional, defaults to "},{"type":"codeVoice","code":"false"},{"type":"text","text":". When "},{"type":"codeVoice","code":"true"},{"type":"text","text":", the node is a terminal leaf and is allowed to have no outgoing choices (e.g., endings) without triggering validation warnings."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"actors"},{"type":"text","text":" (optional): "},{"type":"codeVoice","code":"[ActorDescriptor]"},{"type":"text","text":" — present entities at this location (data‑only)"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Choice objects:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"id"},{"type":"text","text":": "},{"type":"codeVoice","code":"String"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"title"},{"type":"text","text":": "},{"type":"codeVoice","code":"String"},{"type":"text","text":" (optional)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"titleKey"},{"type":"text","text":": "},{"type":"codeVoice","code":"String"},{"type":"text","text":" (optional, for future localization)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"destination"},{"type":"text","text":": "},{"type":"codeVoice","code":"String"},{"type":"text","text":" — NodeID"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"predicates"},{"type":"text","text":": "},{"type":"codeVoice","code":"[PredicateDescriptor]"},{"type":"text","text":" — optional gating checks"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"effects"},{"type":"text","text":": "},{"type":"codeVoice","code":"[EffectDescriptor]"},{"type":"text","text":" — optional effects on select"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Descriptor objects:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"PredicateDescriptor"},{"type":"text","text":": "},{"type":"codeVoice","code":"{ id: String, parameters: { String: String } }"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"EffectDescriptor"},{"type":"text","text":": "},{"type":"codeVoice","code":"{ id: String, parameters: { String: String } }"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Entity\/actor\/global objects:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"EntityDescriptor"},{"type":"text","text":": "},{"type":"codeVoice","code":"{ name?: String, nameKey?: String, tags?: [String], assetKey?: String }"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"ActorDescriptor"},{"type":"text","text":": "},{"type":"codeVoice","code":"{ id: String, ref?: String, name?: String, nameKey?: String, tags?: [String], faction?: String }"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"GlobalAction"},{"type":"text","text":": "},{"type":"codeVoice","code":"{ title?: String, titleKey?: String, destination: String }"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Minimal example:"}]},{"type":"codeListing","code":["{","  \"metadata\": { \"id\": \"demo\", \"title\": \"Demo\", \"version\": 1 },","  \"start\": \"a\",","  \"nodes\": {","    \"a\": {","      \"id\": \"a\",","      \"text\": { \"file\": \"t.md\", \"section\": \"a\" },","      \"tags\": [],","      \"actors\": [ { \"id\": \"g1\", \"ref\": \"goblin\" } ],","      \"onEnter\": [],","      \"choices\": [","        { \"id\": \"go\", \"title\": \"Continue\", \"destination\": \"b\", \"predicates\": [], \"effects\": [] }","      ]","    },","    \"b\": {","      \"id\": \"b\",","      \"text\": { \"file\": \"t.md\", \"section\": \"b\" },","      \"tags\": [],","      \"onEnter\": [],","      \"choices\": [],","      \"terminal\": true","    }","  },","  \"entities\": {","    \"goblin\": { \"name\": \"Goblin\", \"tags\": [\"hostile\"] }","  },","  \"globals\": {","    \"globalActions\": {","      \"playerDied\": { \"title\": \"You Died\", \"destination\": \"b\" }","    }","  }","}"],"syntax":"json"},{"type":"heading","text":"Markdown text files","anchor":"Markdown-text-files","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Markdown files can contain multiple sections, delimited by a line of the form:"}]},{"type":"codeListing","code":["=== node: <section-id> ==="],"syntax":null},{"type":"paragraph","inlineContent":[{"type":"text","text":"Example ("},{"code":"texts\/t.md","type":"codeVoice"},{"type":"text","text":"):"}]},{"type":"codeListing","code":["=== node: a ===","You wake up to the sound of rain.","","=== node: b ===","You step into the hallway."],"syntax":null},{"type":"paragraph","inlineContent":[{"type":"text","text":"Encoding is assumed to be UTF‑8."}]},{"type":"heading","text":"Compiled Bundle (.storybundle)","anchor":"Compiled-Bundle-storybundle","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"The compiler produces a directory‑based bundle that mirrors the source in a normalized form:"}]},{"type":"codeListing","code":["My.storybundle\/","  manifest.json","  graph.json","  texts\/","    *.md"],"syntax":null},{"type":"heading","text":"graph.json","anchor":"graphjson","level":3},{"type":"paragraph","inlineContent":[{"code":"graph.json","type":"codeVoice"},{"type":"text","text":" is the normalized story graph used by the runtime. It has the same JSON shape as "},{"code":"story.json","type":"codeVoice"},{"type":"text","text":" but is produced by the compiler (e.g., after transforms). In the initial implementation, it is a copy of "},{"code":"story.json","type":"codeVoice"},{"type":"text","text":"."}]},{"type":"heading","text":"manifest.json","anchor":"manifestjson","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"The manifest records basic metadata about the compiled bundle:"}]},{"type":"codeListing","code":["{","  \"schemaVersion\": 1,","  \"storyID\": \"demo\",","  \"title\": \"Demo\",","  \"version\": 1,","  \"graphHashSHA256\": \"<hex sha256 of graph.json>\",","  \"builtAt\": 1737072000","}"],"syntax":"json"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"schemaVersion"},{"type":"text","text":": Monotonically increasing schema identifier."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"storyID"},{"type":"text","text":", "},{"type":"codeVoice","code":"title"},{"type":"text","text":", "},{"type":"codeVoice","code":"version"},{"type":"text","text":": Copied from story metadata."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"graphHashSHA256"},{"type":"text","text":": Hex‑encoded SHA‑256 of "},{"type":"codeVoice","code":"graph.json"},{"type":"text","text":" for integrity."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"builtAt"},{"type":"text","text":": Build timestamp as encoded by "},{"type":"codeVoice","code":"JSONEncoder"},{"type":"text","text":" (numeric seconds by default)."}],"type":"paragraph"}]}]},{"type":"heading","text":"texts\/","anchor":"texts","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Markdown files are copied from the source "},{"code":"texts\/","type":"codeVoice"},{"type":"text","text":" directory without modification. They are resolved at runtime by the text providers."}]},{"type":"heading","text":"Graph Exports (CLI)","anchor":"Graph-Exports-CLI","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"code":"storykit graph","type":"codeVoice"},{"type":"text","text":" command can export edges in several formats (written to stdout by default):"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"text"},{"type":"text","text":": One line per edge — "},{"type":"codeVoice","code":"from -> to"},{"type":"text","text":"."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"dot"},{"type":"text","text":": GraphViz DOT — declares nodes and edges, suitable for visualization."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"json"},{"type":"text","text":": Array of edges — "},{"type":"codeVoice","code":"[ { \"from\": String, \"to\": String } ]"},{"type":"text","text":"."}],"type":"paragraph"}]}]}],"kind":"content"}],"kind":"article","hierarchy":{"paths":[["doc:\/\/StoryKit\/documentation\/StoryKit"]]},"identifier":{"url":"doc:\/\/StoryKit\/documentation\/StoryKit\/DataFormats","interfaceLanguage":"swift"},"metadata":{"modules":[{"name":"StoryKit"}],"roleHeading":"Article","role":"article","title":"Data Formats"},"schemaVersion":{"patch":0,"major":0,"minor":3},"sections":[],"abstract":[{"text":"Understand the on‑disk formats used for authoring, compilation, and runtime.","type":"text"}],"references":{"doc://StoryKit/documentation/StoryKit":{"identifier":"doc:\/\/StoryKit\/documentation\/StoryKit","title":"StoryKit","url":"\/documentation\/storykit","role":"collection","type":"topic","kind":"symbol","abstract":[{"text":"Build rich, data‑driven “choose your own adventure” experiences with a small, composable core and first‑class tooling.","type":"text"}]}}}